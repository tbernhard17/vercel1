const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Index-DCT4WgU4.js","./react-vendor-Bjmm3TQb.js","./radix-vendor-D4Vu8pH4.js","./ui-utils-vendor-DfznwCci.js","./data-vendor-Clh74PRC.js","./NotFound-C9ncovL7.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,r)=>((t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r)(t,"symbol"!=typeof s?s+"":s,r);import{r as s,j as r,H as a,d as o,e as n,f as i}from"./react-vendor-Bjmm3TQb.js";import{V as c,R as l,A as d,C as u,T as p,D as m,P as f,a as g,b as h,c as y,d as b,S as v}from"./radix-vendor-D4Vu8pH4.js";import{t as x,c as w,X as _,a as j,j as S,T as N,b as E}from"./ui-utils-vendor-DfznwCci.js";import{Q as k,a as T}from"./data-vendor-Clh74PRC.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const A={},P=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),o=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));r=Promise.allSettled(t.map((t=>{if(t=function(e,t){return new URL(e,t).href}(t,s),t in A)return;A[t]=!0;const r=t.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(!!s)for(let s=e.length-1;s>=0;s--){const a=e[s];if(a.href===t&&(!r||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const n=document.createElement("link");return n.rel=r?"stylesheet":"modulepreload",r||(n.as="script"),n.crossOrigin="",n.href=t,o&&n.setAttribute("nonce",o),document.head.appendChild(n),r?new Promise(((e,s)=>{n.addEventListener("load",e),n.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))};let I=0;const O=new Map,z=e=>{if(O.has(e))return;const t=setTimeout((()=>{O.delete(e),F({type:"REMOVE_TOAST",toastId:e})}),1e6);O.set(e,t)},R=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case"DISMISS_TOAST":{const{toastId:s}=t;return s?z(s):e.toasts.forEach((e=>{z(e.id)})),{...e,toasts:e.toasts.map((e=>e.id===s||void 0===s?{...e,open:!1}:e))}}case"REMOVE_TOAST":return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))}}},C=[];let M={toasts:[]};function F(e){M=R(M,e),C.forEach((e=>{e(M)}))}function D({...e}){const t=(I=(I+1)%Number.MAX_SAFE_INTEGER,I.toString()),s=()=>F({type:"DISMISS_TOAST",toastId:t});return F({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>F({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function L(){const[e,t]=s.useState(M);return s.useEffect((()=>(C.push(t),()=>{const e=C.indexOf(t);e>-1&&C.splice(e,1)})),[e]),{...e,toast:D,dismiss:e=>F({type:"DISMISS_TOAST",toastId:e})}}function $(...e){return x(w(e))}const V=f,q=s.forwardRef((({className:e,...t},s)=>r.jsx(c,{ref:s,className:$("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t})));q.displayName=c.displayName;const B=j("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),U=s.forwardRef((({className:e,variant:t,...s},a)=>r.jsx(l,{ref:a,className:$(B({variant:t}),e),...s})));U.displayName=l.displayName;s.forwardRef((({className:e,...t},s)=>r.jsx(d,{ref:s,className:$("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}))).displayName=d.displayName;const W=s.forwardRef((({className:e,...t},s)=>r.jsx(u,{ref:s,className:$("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:r.jsx(_,{className:"h-4 w-4"})})));W.displayName=u.displayName;const G=s.forwardRef((({className:e,...t},s)=>r.jsx(p,{ref:s,className:$("text-sm font-semibold",e),...t})));G.displayName=p.displayName;const H=s.forwardRef((({className:e,...t},s)=>r.jsx(m,{ref:s,className:$("text-sm opacity-90",e),...t})));function J(){const{toasts:e}=L();return r.jsxs(V,{children:[e.map((function({id:e,title:t,description:s,action:a,...o}){return r.jsxs(U,{...o,children:[r.jsxs("div",{className:"grid gap-1",children:[t&&r.jsx(G,{children:t}),s&&r.jsx(H,{children:s})]}),a,r.jsx(W,{})]},e)})),r.jsx(q,{})]})}H.displayName=m.displayName;const K=({...e})=>{const{theme:t="system"}=S();return r.jsx(N,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},Q=h,X=y,Y=b,Z=s.forwardRef((({className:e,sideOffset:t=4,...s},a)=>r.jsx(g,{ref:a,sideOffset:t,className:$("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})));Z.displayName=g.displayName;const ee=s.createContext({lipsyncSettings:{algorithm:"sadtalker",quality:70,useBeatAnalysis:!1,faceDetectionThreshold:.5,useLyricAlignment:!1,pads:{top:0,bottom:10,left:0,right:0},resizeFactor:1,nosmooth:!1,stillMode:!1,poseStyle:0,batchSize:2,useEnhancer:!1,preprocessMode:"crop",expressionScale:1,face3dVis:!1},voiceSettings:{model:"rvc",quality:80,enableTraining:!1,trainingEpochs:100,pitchCorrection:0},updateLipsyncSettings:()=>{},updateVoiceSettings:()=>{},getLipsyncSettingsForAPI:()=>({}),getVoiceSettingsForAPI:()=>({})}),te=({children:e})=>{const[t,a]=s.useState({algorithm:"sadtalker",quality:70,useBeatAnalysis:!1,faceDetectionThreshold:.5,useLyricAlignment:!1,pads:{top:0,bottom:10,left:0,right:0},resizeFactor:1,nosmooth:!1,stillMode:!1,poseStyle:0,batchSize:2,useEnhancer:!1,preprocessMode:"crop",expressionScale:1,face3dVis:!1}),[o,n]=s.useState({model:"rvc",quality:80,enableTraining:!1,trainingEpochs:100,pitchCorrection:0});return r.jsx(ee.Provider,{value:{lipsyncSettings:t,voiceSettings:o,updateLipsyncSettings:e=>{a((t=>({...t,...e,pads:{...t.pads,...e.pads||{}}})))},updateVoiceSettings:e=>{n((t=>({...t,...e})))},getLipsyncSettingsForAPI:()=>{const{pads:e,...s}=t,r={...s,pads:`${e.top} ${e.bottom} ${e.left} ${e.right}`,resize_factor:t.resizeFactor,use_beat_analysis:t.useBeatAnalysis,use_lyric_alignment:t.useLyricAlignment,face_detection_threshold:t.faceDetectionThreshold};return"sadtalker"===t.algorithm?{...r,pose_style:t.poseStyle,batch_size:t.batchSize,still:t.stillMode,use_enhancer:t.useEnhancer,preprocess_mode:t.preprocessMode,expression_scale:t.expressionScale,ref_eyeblink:t.refEyeblink,ref_pose:t.refPose,face3d_vis:t.face3dVis,input_yaw:t.inputYaw,input_pitch:t.inputPitch,input_roll:t.inputRoll}:"geneface"===t.algorithm?{...r,frame_rate:t.frameRate,use_high_quality_mode:t.useHighQualityMode,neural_model_type:t.neuralModelType,expression_intensity:t.expressionIntensity,enable_post_processing:t.enablePostProcessing,preserve_background:t.preserveBackground,enable_super_resolution:t.enableSuperResolution,upscale_factor:t.upscaleFactor,gpu_acceleration:t.gpuAcceleration,precision:t.precision,enable_audio_preprocessing:t.enableAudioPreprocessing,enable_audio_normalization:t.enableAudioNormalization,audio_sample_rate:t.audioSampleRate,audio_path:t.audioPath}:"wav2lip"===t.algorithm?{...r,batch_size:t.batchSize,use_enhancer:t.useEnhancer,use_background_enhancer:t.useBackgroundEnhancer,preprocess_mode:t.preprocessMode,mask_dilate:t.maskDilate,mask_blur:t.maskBlur,enable_face_swap:t.enableFaceSwap,face_swap_image:t.faceSwapImage,zero_mouth:t.zeroMouth,show_frame_number:t.showFrameNumber,volume_amplification:t.volumeAmplification,delay_start_time:t.delayStartTime,enable_keyframe_manager:t.enableKeyframeManager,auto_mask:t.autoMask,driving_video:t.drivingVideo,driving_avatar:t.drivingAvatar,enable_comfy_ui:t.enableComfyUI,nosmooth:t.nosmooth}:r},getVoiceSettingsForAPI:()=>({model:o.model,quality:o.quality,enable_training:o.enableTraining,training_epochs:o.trainingEpochs,pitch_correction:o.pitchCorrection})},children:e})},se=()=>s.useContext(ee),re={version:"/v1",basePath:"/api",get fullPath(){return`${this.basePath}${this.version}`}},ae=e=>{const t=e.startsWith("/")?e:`/${e}`;return`${re.fullPath}${t}`},oe=async(e,t={})=>{try{const a=ae(e);t.headers||(t.headers={Accept:"application/json","Cache-Control":"no-cache",Pragma:"no-cache"});const o=t.headers;!t.body||o["Content-Type"]||t.body instanceof FormData||(o["Content-Type"]="application/json");const n=await fetch(a,t);if(!n.ok){let e=`Request failed with status ${n.status}`,t=null;try{t=await n.json(),e=t.detail||t.message||e}catch(s){try{e=await n.text()||e}catch(r){}}return{success:!1,error:e,status:n.status}}const i=n.headers.get("content-type");if(i&&i.includes("application/json")){return{success:!0,data:await n.json()}}return{success:!0,data:null}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Network error occurred"}}},ne={start:async e=>{const t=await oe("/lip_sync/start",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.success)throw new Error(t.error||"Failed to start lip sync job");return t.data},preloadEngine:async e=>{try{const t=await oe(`/lip_sync/engine/preload?engine=${e}`,{method:"GET"});return t.success?{success:!0,status:"ready",message:"Engine preloaded successfully"}:{success:!1,status:"error",error:t.error||"Failed to preload engine",fallback:!0,message:"Using fallback engine"}}catch(t){return{success:!1,status:"error",fallback:!0,message:"Using fallback engine due to error"}}},updateSettings:async e=>{try{const t=await oe("/lip_sync/settings",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.success){if(405===t.status||404===t.status)throw new Error("Advanced lipsync settings endpoint is not available (405/404). Please check backend routes.");throw new Error(t.error||"Failed to update lipsync settings")}return t.data}catch(t){throw t}}},ie=s.createContext(void 0),ce="wav2lip",le=({children:e})=>{const[t,a]=s.useState({wav2lip:{id:"wav2lip",name:"Wav2Lip",status:"idle"},sadtalker:{id:"sadtalker",name:"SadTalker",status:"idle"}}),[o,n]=s.useState(ce),[i,c]=s.useState("idle"),l=(e,t,s)=>{a((r=>({...r,[e]:{...r[e],status:t,errorMessage:s??void 0}}))),e===o&&c(t)},d=s.useCallback((async e=>{l(e,"loading");try{const t=await ne.preloadEngine(e);if(t.success&&"ready"===t.status&&!t.fallback)l(e,"ready");else{if(!t.fallback)throw new Error(t.error||`Preload failed for ${e}`);l(e,"ready",`Fallback: ${t.message||"Unknown reason"}`)}}catch(t){l(e,"error",t instanceof Error?t.message:"Unknown error")}}),[o]);s.useEffect((()=>{d(ce),c(t[ce].status)}),[]),s.useEffect((()=>{let e={wav2lip:0,sadtalker:0};const s=setInterval((async()=>{for(const r of Object.keys(t))try{const t=await fetch(`/api/v1/lip_sync/engine/status?engine=${r}`);if(!t.ok)throw new Error(`Status not ok: ${t.status}`);const s=await t.json();s.loaded&&"available"===s.status?(l(r,"ready"),e[r]=0):s.loaded||"unavailable"!==s.status?(l(r,"idle"),e[r]=0):(l(r,"loading"),e[r]=0)}catch(s){e[r]=(e[r]||0)+1,e[r]>=3&&l(r,"error","Failed to poll engine status")}}),2e3);return()=>clearInterval(s)}),[t,o]);const u=s.useCallback((async e=>{var s;if(e===o)return;n(e);const r=null==(s=t[e])?void 0:s.status;"ready"!==r?"loading"!==r?await d(e):c("loading"):c("ready")}),[o,t,d]),p="ready"===i;return r.jsx(ie.Provider,{value:{engines:t,currentEngine:o,engineStatus:i,isEngineReady:p,changeEngine:u,preloadEngine:d},children:e})},de=()=>{const e=s.useContext(ie);if(void 0===e)throw new Error("useEngines must be used within an EngineProvider");return e};function ue({size:e="md",className:t}){return r.jsx("div",{className:$("animate-spin rounded-full border-t-transparent border-primary",{sm:"h-4 w-4 border-2",md:"h-6 w-6 border-2",lg:"h-8 w-8 border-3",xl:"h-12 w-12 border-4"}[e],t),role:"status","aria-label":"loading",children:r.jsx("span",{className:"sr-only",children:"Loading..."})})}const pe=j("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),me=s.forwardRef((({className:e,variant:t,size:s,asChild:a=!1,...o},n)=>{const i=a?v:"button";return r.jsx(i,{className:$(pe({variant:t,size:s,className:e})),ref:n,...o})}));me.displayName="Button";class fe extends s.Component{constructor(e){super(e),t(this,"handleReset",(()=>{this.setState({hasError:!1,error:null,errorInfo:null})})),t(this,"handleReload",(()=>{window.location.reload()})),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({errorInfo:t})}render(){var e;return this.state.hasError?this.props.fallback?this.props.fallback:r.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-gray-900 to-purple-900 text-white p-6",children:r.jsxs("div",{className:"max-w-md w-full bg-gray-800/80 backdrop-blur-sm p-8 rounded-lg shadow-lg border border-purple-500/30",children:[r.jsx("div",{className:"flex items-center justify-center mb-6",children:r.jsx(E,{className:"h-12 w-12 text-red-400"})}),r.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:"Something went wrong"}),r.jsxs("div",{className:"bg-gray-900/60 p-4 rounded mb-6 overflow-auto max-h-40",children:[r.jsx("p",{className:"font-mono text-sm text-red-300 mb-2",children:null==(e=this.state.error)?void 0:e.toString()}),this.state.errorInfo&&r.jsxs("details",{className:"mt-2",children:[r.jsx("summary",{className:"text-sm cursor-pointer text-gray-400 hover:text-white",children:"View stack trace"}),r.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs text-gray-400 overflow-auto max-h-32",children:this.state.errorInfo.componentStack})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[r.jsx(me,{onClick:this.handleReset,className:"flex-1 bg-purple-700 hover:bg-purple-600",children:"Try to recover"}),r.jsx(me,{onClick:this.handleReload,className:"flex-1 bg-gray-700 hover:bg-gray-600",children:"Reload page"})]})]})}):this.props.children}}const ge=s.lazy((()=>P((()=>import("./Index-DCT4WgU4.js")),__vite__mapDeps([0,1,2,3,4]),import.meta.url))),he=s.lazy((()=>P((()=>import("./NotFound-C9ncovL7.js")),__vite__mapDeps([5,1]),import.meta.url))),ye=()=>r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsx(ue,{size:"lg"})}),be=new k({defaultOptions:{queries:{retry:2,refetchOnWindowFocus:!1}}}),ve=()=>r.jsx(fe,{children:r.jsx(T,{client:be,children:r.jsx(Q,{children:r.jsx(te,{children:r.jsxs(le,{children:[r.jsx(J,{}),r.jsx(K,{}),r.jsx(a,{children:r.jsx(s.Suspense,{fallback:r.jsx(ye,{}),children:r.jsxs(o,{children:[r.jsx(n,{path:"/",element:r.jsx(ge,{})}),r.jsx(n,{path:"*",element:r.jsx(he,{})})]})})})]})})})})});i(document.getElementById("root")).render(r.jsx(ve,{}));export{me as B,Q as T,X as a,Y as b,$ as c,Z as d,L as e,de as f,ae as g,ne as l,D as t,se as u};
